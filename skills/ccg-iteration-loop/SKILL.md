---
name: ccg-iteration-loop
description: |
  æŒç»­è¿­ä»£å¾ªç¯ï¼šè‡ªåŠ¨è§„åˆ’ã€å®ç°ã€æµ‹è¯•ã€å®¡æ ¸ã€åˆå…¥ï¼Œå¾ªç¯æ‰§è¡Œç›´åˆ°æ‰€æœ‰ä»»åŠ¡å®Œæˆã€‚
  Use when: éœ€è¦è‡ªåŠ¨åŒ–æ‰§è¡Œå¤šä¸ªä»»åŠ¡ï¼Œå®ç°æŒç»­è¿­ä»£å¼€å‘ã€‚
  æ”¯æŒä»è®¾è®¡æ–‡æ¡£å¯åŠ¨ï¼ˆå…¨æ–°é¡¹ç›®ï¼‰æˆ–ä»ç°æœ‰é¡¹ç›®å¯åŠ¨ï¼ˆå·²æœ‰ä»£ç ï¼‰ã€‚
---

# CCG æŒç»­è¿­ä»£å¾ªç¯

## åŠŸèƒ½å®šä½

**æŒç»­è¿­ä»£å¾ªç¯**ï¼šå®ç°è‡ªåŠ¨åŒ–çš„"è§„åˆ’ â†’ å®ç° â†’ æµ‹è¯• â†’ å®¡æ ¸ â†’ åˆå…¥"å¾ªç¯ï¼Œç›´åˆ°æ‰€æœ‰ä»»åŠ¡å®Œæˆã€‚

### æ ¸å¿ƒä»·å€¼

1. **å®Œå…¨è‡ªåŠ¨åŒ–**ï¼šä¸€æ¬¡å¯åŠ¨ï¼Œè‡ªåŠ¨æ‰§è¡Œæ‰€æœ‰ä»»åŠ¡
2. **é˜²æ­¢é‡å¤å¼€å‘**ï¼šä¸‰é‡æ£€æµ‹æœºåˆ¶ï¼Œç¡®ä¿ä»»åŠ¡ä¸é‡å¤æ‰§è¡Œ
3. **æ”¯æŒ Git å›é€€**ï¼šæ¯ä¸ªä»»åŠ¡ä¸€ä¸ªæäº¤ï¼Œå®Œæ•´è®°å½•ï¼Œéšæ—¶å›é€€
4. **å¤±è´¥ä¸é˜»å¡**ï¼šä»»åŠ¡å¤±è´¥è‡ªåŠ¨è·³è¿‡ï¼Œç»§ç»­ä¸‹ä¸€ä¸ªä»»åŠ¡
5. **æ–­ç‚¹ç»­æ‰§è¡Œ**ï¼šæ”¯æŒä¸­æ–­åæ¢å¤æ‰§è¡Œ

---

## å¯åŠ¨æ¨¡å¼

### æ¨¡å¼ 1ï¼šä»è®¾è®¡æ–‡æ¡£å¯åŠ¨ï¼ˆå…¨æ–°é¡¹ç›®ï¼‰

**é€‚ç”¨åœºæ™¯**ï¼š
- å·²å®Œæˆè¯¦ç»†çš„éœ€æ±‚è®¾è®¡
- å·²å®Œæˆæ•°æ®åº“è®¾è®¡ï¼ˆå¦‚æ¶‰åŠæ•°æ®åº“ï¼‰
- å‡†å¤‡å¼€å§‹ç¼–ç å®ç°

**å¯åŠ¨å‘½ä»¤**ï¼š
```bash
/ccg-iteration-loop --requirement-dir ai/requirements/<project>/
```

**å‰ç½®æ¡ä»¶**ï¼š
- å¿…éœ€æ–‡ä»¶ï¼š`requirements.md`ï¼ˆéœ€æ±‚æ–‡æ¡£ï¼‰
- æ¡ä»¶å¿…éœ€ï¼š`database-design.md`ï¼ˆå¦‚æœé¡¹ç›®æ¶‰åŠæ•°æ®å­˜å‚¨ï¼‰

**æ‰§è¡Œæµç¨‹**ï¼š
```
1. æ£€æŸ¥è®¾è®¡æ–‡æ¡£å®Œæ•´æ€§
2. Codex + Claude åŒé‡åˆ†æ
   - Claude åˆ†æï¼šé¡¹ç›®ç»“æ„ã€æŠ€æœ¯æ ˆã€å®ç°è·¯å¾„
   - Codex åˆ†æï¼šæ¶æ„è®¾è®¡ã€æ½œåœ¨é£é™©ã€æœ€ä½³å®è·µ
   - ç»¼åˆä¸¤è€…æ„è§ï¼Œå½¢æˆç»Ÿä¸€åˆ†ææ–‡æ¡£
3. ç”Ÿæˆé¡¹ç›®åˆ†ææ–‡æ¡£ï¼ˆai/analysis/<project>-analysis.mdï¼‰
4. ç”Ÿæˆä»»åŠ¡åˆ—è¡¨ï¼ˆai/iteration/<project>/task-list.mdï¼‰
5. ã€ç”¨æˆ·ç¡®è®¤ç¯èŠ‚ã€‘å±•ç¤ºä»»åŠ¡åˆ—è¡¨ï¼Œè¯¢é—®ï¼š
   - æ˜¯å¦æœ‰éœ€è¦è·³è¿‡çš„ä»»åŠ¡ï¼Ÿ
   - æ˜¯å¦éœ€è¦è°ƒæ•´ä»»åŠ¡ä¼˜å…ˆçº§ï¼Ÿ
   - æ˜¯å¦éœ€è¦æ·»åŠ æ–°ä»»åŠ¡ï¼Ÿ
6. æ ¹æ®ç”¨æˆ·åé¦ˆæ›´æ–°ä»»åŠ¡åˆ—è¡¨
7. æ£€æŸ¥ Git çŠ¶æ€
8. å¼€å§‹è¿­ä»£å¾ªç¯
```

---

### æ¨¡å¼ 2ï¼šä»ç°æœ‰é¡¹ç›®å¯åŠ¨ï¼ˆå·²æœ‰ä»£ç ï¼‰

**é€‚ç”¨åœºæ™¯**ï¼š
- å·²æœ‰ä»£ç åº“ï¼Œéœ€è¦ç»§ç»­å¼€å‘
- éœ€è¦æ·»åŠ æ–°åŠŸèƒ½æˆ–å®Œå–„ç°æœ‰åŠŸèƒ½
- éœ€è¦åˆ†æç°æœ‰ä»£ç åå†è§„åˆ’

**å¯åŠ¨å‘½ä»¤**ï¼š
```bash
/ccg-iteration-loop --analyze-project --goal "å®Œå–„ç”¨æˆ·ç®¡ç†ç³»ç»Ÿï¼Œæ·»åŠ æƒé™æ§åˆ¶å’Œæ•°æ®å¯¼å‡ºåŠŸèƒ½"
```

**æ‰§è¡Œæµç¨‹**ï¼š
```
1. Codex + Claude åŒé‡åˆ†æé¡¹ç›®
   - Claude åˆ†æï¼š
     * æ‰«æé¡¹ç›®ç»“æ„
     * è¯†åˆ«æŠ€æœ¯æ ˆ
     * åˆ†æå·²å®ç°åŠŸèƒ½
     * åˆ†ææ•°æ®åº“ç»“æ„
   - Codex åˆ†æï¼š
     * æ¶æ„è¯„ä¼°
     * ä»£ç è´¨é‡è¯„ä¼°
     * æ½œåœ¨é—®é¢˜è¯†åˆ«
     * æ”¹è¿›å»ºè®®
   - ç»¼åˆä¸¤è€…æ„è§ï¼Œå½¢æˆç»Ÿä¸€åˆ†ææ–‡æ¡£
2. ç”Ÿæˆé¡¹ç›®åˆ†ææ–‡æ¡£ï¼ˆai/analysis/<project>-analysis.mdï¼‰
3. ç”Ÿæˆä»»åŠ¡åˆ—è¡¨ï¼ˆai/iteration/<project>/task-list.mdï¼‰
4. ã€ç”¨æˆ·ç¡®è®¤ç¯èŠ‚ã€‘å±•ç¤ºä»»åŠ¡åˆ—è¡¨ï¼Œè¯¢é—®ï¼š
   - æ˜¯å¦æœ‰éœ€è¦è·³è¿‡çš„ä»»åŠ¡ï¼Ÿ
   - æ˜¯å¦éœ€è¦è°ƒæ•´ä»»åŠ¡ä¼˜å…ˆçº§ï¼Ÿ
   - æ˜¯å¦éœ€è¦æ·»åŠ æ–°ä»»åŠ¡ï¼Ÿ
5. æ ¹æ®ç”¨æˆ·åé¦ˆæ›´æ–°ä»»åŠ¡åˆ—è¡¨
6. æ£€æŸ¥ Git çŠ¶æ€
7. å¼€å§‹è¿­ä»£å¾ªç¯
```

---

### æ¨¡å¼ 3ï¼šæ–­ç‚¹ç»­æ‰§è¡Œ

**é€‚ç”¨åœºæ™¯**ï¼š
- è¿­ä»£å¾ªç¯ä¸­é€”ä¸­æ–­
- éœ€è¦ä»ä¸­æ–­ç‚¹ç»§ç»­æ‰§è¡Œ

**å¯åŠ¨å‘½ä»¤**ï¼š
```bash
/ccg-iteration-loop --resume ai/iteration/<project>/progress.json
```

**æ‰§è¡Œæµç¨‹**ï¼š
```
1. è¯»å–è¿›åº¦æ–‡ä»¶
2. æ£€æµ‹å½“å‰çŠ¶æ€
3. è¯¢é—®ç”¨æˆ·æ˜¯å¦ç»§ç»­
4. ä»ä¸­æ–­ç‚¹ç»§ç»­æ‰§è¡Œ
```

---

## Codex + Claude åŒé‡åˆ†ææœºåˆ¶

### ä¸ºä»€ä¹ˆéœ€è¦åŒé‡åˆ†æï¼Ÿ

- **Claude ä¼˜åŠ¿**ï¼šå¿«é€Ÿç†è§£é¡¹ç›®ç»“æ„ã€è¯†åˆ«æŠ€æœ¯æ ˆã€æ¢³ç†å®ç°è·¯å¾„
- **Codex ä¼˜åŠ¿**ï¼šæ¶æ„è®¾è®¡è¯„ä¼°ã€ä»£ç è´¨é‡æŠŠå…³ã€è¯†åˆ«æ½œåœ¨é£é™©
- **ç»¼åˆæ•ˆæœ**ï¼šäº’è¡¥è§†è§’ï¼Œå½¢æˆæ›´å…¨é¢ã€æ›´å¯é çš„åˆ†æç»“æœ

### åˆ†ææµç¨‹

```
æ­¥éª¤ 1ï¼šClaude åˆæ­¥åˆ†æï¼ˆ5-10 åˆ†é’Ÿï¼‰
  â†“
  - æ‰«æé¡¹ç›®ç›®å½•ç»“æ„
  - è¯†åˆ«æŠ€æœ¯æ ˆå’Œä¾èµ–
  - åˆ†æå·²å®ç°åŠŸèƒ½
  - è¯†åˆ«æ•°æ®åº“ç»“æ„
  - ç”Ÿæˆåˆæ­¥åˆ†ææŠ¥å‘Š
  â†“
æ­¥éª¤ 2ï¼šCodex æ·±åº¦åˆ†æï¼ˆ10-15 åˆ†é’Ÿï¼‰
  â†“
  - é˜…è¯» Claude çš„åˆæ­¥åˆ†æ
  - è¯„ä¼°æ¶æ„è®¾è®¡åˆç†æ€§
  - è¯†åˆ«ä»£ç è´¨é‡é—®é¢˜
  - å‘ç°æ½œåœ¨é£é™©å’ŒæŠ€æœ¯å€º
  - æä¾›æ”¹è¿›å»ºè®®å’Œæœ€ä½³å®è·µ
  â†“
æ­¥éª¤ 3ï¼šClaude ç»¼åˆæ•´ç†ï¼ˆ5 åˆ†é’Ÿï¼‰
  â†“
  - æ•´åˆä¸¤è€…åˆ†æç»“æœ
  - è§£å†³åˆ†æ­§ï¼ˆå¦‚æœ‰ï¼‰
  - ç”Ÿæˆç»Ÿä¸€çš„é¡¹ç›®åˆ†ææ–‡æ¡£
  - ä¿å­˜åˆ° ai/analysis/<project>-analysis.md
```

### åˆ†ææ–‡æ¡£ç»“æ„

```markdown
# é¡¹ç›®åˆ†ææ–‡æ¡£

## 1. é¡¹ç›®æ¦‚å†µ
- é¡¹ç›®åç§°
- æŠ€æœ¯æ ˆ
- ç›®å½•ç»“æ„

## 2. å·²å®ç°åŠŸèƒ½ï¼ˆClaude åˆ†æï¼‰
- åŠŸèƒ½åˆ—è¡¨
- å®ç°çŠ¶æ€

## 3. æ¶æ„è¯„ä¼°ï¼ˆCodex åˆ†æï¼‰
- æ¶æ„æ¨¡å¼
- è®¾è®¡ä¼˜ç‚¹
- æ½œåœ¨é—®é¢˜

## 4. ä»£ç è´¨é‡è¯„ä¼°ï¼ˆCodex åˆ†æï¼‰
- ä»£ç è§„èŒƒ
- æµ‹è¯•è¦†ç›–ç‡
- æŠ€æœ¯å€ºåŠ¡

## 5. æ”¹è¿›å»ºè®®ï¼ˆç»¼åˆæ„è§ï¼‰
- ä¼˜å…ˆçº§é«˜çš„æ”¹è¿›
- ä¼˜å…ˆçº§ä¸­çš„æ”¹è¿›
- ä¼˜å…ˆçº§ä½çš„æ”¹è¿›

## 6. ä»»åŠ¡è§„åˆ’å»ºè®®
- å»ºè®®çš„ä»»åŠ¡æ‹†åˆ†
- ä»»åŠ¡ä¾èµ–å…³ç³»
- é¢„ä¼°å·¥ä½œé‡
```

---

## ç”¨æˆ·ç¡®è®¤ç¯èŠ‚

### ä»»åŠ¡åˆ—è¡¨å±•ç¤ºæ ¼å¼

ç”Ÿæˆä»»åŠ¡åˆ—è¡¨åï¼ŒClaude ä¼šä»¥ä»¥ä¸‹æ ¼å¼å±•ç¤ºï¼š

```
ğŸ“‹ ä»»åŠ¡åˆ—è¡¨å·²ç”Ÿæˆï¼ˆå…± 8 ä¸ªä»»åŠ¡ï¼‰

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Task 1: å®ç°æƒé™æ§åˆ¶æ•°æ®åº“ç»“æ„                          â”‚
â”‚ ä¼˜å…ˆçº§: é«˜ | é¢„ä¼°: 6h | ä¾èµ–: æ—                         â”‚
â”‚ æ–‡ä»¶: src/models/role.py, src/models/permission.py     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Task 2: å®ç°è§’è‰²ç®¡ç† API                                â”‚
â”‚ ä¼˜å…ˆçº§: é«˜ | é¢„ä¼°: 4h | ä¾èµ–: Task 1                    â”‚
â”‚ æ–‡ä»¶: src/api/roles.py, src/services/role_service.py   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

... (å…¶ä»–ä»»åŠ¡)

â“ è¯·ç¡®è®¤ï¼š
1. æ˜¯å¦æœ‰éœ€è¦è·³è¿‡çš„ä»»åŠ¡ï¼Ÿï¼ˆè¾“å…¥ä»»åŠ¡ç¼–å·ï¼Œå¦‚ï¼š3,5ï¼‰
2. æ˜¯å¦éœ€è¦è°ƒæ•´ä¼˜å…ˆçº§ï¼Ÿï¼ˆè¾“å…¥ï¼štask-2 -> highï¼‰
3. æ˜¯å¦éœ€è¦æ·»åŠ æ–°ä»»åŠ¡ï¼Ÿï¼ˆè¾“å…¥ï¼šaddï¼‰
4. ç¡®è®¤æ— è¯¯ï¼Œå¼€å§‹æ‰§è¡Œï¼Ÿï¼ˆè¾“å…¥ï¼šyï¼‰
```

### ç”¨æˆ·æ“ä½œé€‰é¡¹

**é€‰é¡¹ 1ï¼šè·³è¿‡ä»»åŠ¡**
```
ç”¨æˆ·è¾“å…¥ï¼šskip 3,5
  â†“
Claude ç¡®è®¤ï¼š
  "å°†è·³è¿‡ä»¥ä¸‹ä»»åŠ¡ï¼š
   - Task 3: å®ç°æƒé™æ£€æŸ¥ä¸­é—´ä»¶
   - Task 5: å®ç°æ•°æ®å¯¼å‡ºåŠŸèƒ½

   è¿™äº›ä»»åŠ¡å°†æ ‡è®°ä¸º 'skipped'ï¼Œä¸ä¼šæ‰§è¡Œã€‚
   æ˜¯å¦ç¡®è®¤ï¼Ÿ[y/N]"
```

**é€‰é¡¹ 2ï¼šè°ƒæ•´ä¼˜å…ˆçº§**
```
ç”¨æˆ·è¾“å…¥ï¼špriority task-2=medium, task-6=high
  â†“
Claude æ›´æ–°ä»»åŠ¡åˆ—è¡¨å¹¶é‡æ–°æ’åº
```

**é€‰é¡¹ 3ï¼šæ·»åŠ æ–°ä»»åŠ¡**
```
ç”¨æˆ·è¾“å…¥ï¼šadd
  â†“
Claude è¯¢é—®ï¼š
  "è¯·æè¿°æ–°ä»»åŠ¡ï¼š
   - ä»»åŠ¡åç§°ï¼š
   - ä¼˜å…ˆçº§ï¼š[high/medium/low]
   - ä¾èµ–ä»»åŠ¡ï¼š[å¯é€‰]
   - é¢„ä¼°å·¥ä½œé‡ï¼š[å°æ—¶]"
```

**é€‰é¡¹ 4ï¼šç¡®è®¤å¼€å§‹**
```
ç”¨æˆ·è¾“å…¥ï¼šy
  â†“
Claude ä¿å­˜æœ€ç»ˆä»»åŠ¡åˆ—è¡¨
  â†“
æ£€æŸ¥ Git çŠ¶æ€
  â†“
å¼€å§‹è¿­ä»£å¾ªç¯
```

---

## è¿­ä»£å¾ªç¯æµç¨‹

### å¾ªç¯æ­¥éª¤ï¼ˆ8 æ­¥ï¼‰

```
ã€å¾ªç¯å¼€å§‹ã€‘
  â†“
æ­¥éª¤ 1ï¼šé€‰æ‹©ä¸‹ä¸€ä¸ªä»»åŠ¡
  - è·³è¿‡å·²å®Œæˆçš„ä»»åŠ¡
  - æ£€æŸ¥ä¾èµ–æ˜¯å¦æ»¡è¶³
  - é€‰æ‹©ç¬¬ä¸€ä¸ªå¯æ‰§è¡Œä»»åŠ¡
  â†“
æ­¥éª¤ 2ï¼šç”Ÿæˆä»»åŠ¡è®¡åˆ’
  - è°ƒç”¨ /ccg-plan
  - ä¿å­˜åˆ° ai/plans/<task-name>.md
  - æ›´æ–° progress.jsonï¼ˆæ ‡è®°ä¸º in_progressï¼‰
  â†“
æ­¥éª¤ 3ï¼šæ‰§è¡Œè®¡åˆ’
  - è°ƒç”¨ /ccg-execute
  - é€æ­¥æ‰§è¡Œè®¡åˆ’
  - Claude éªŒæ”¶æ¯ä¸ªæ­¥éª¤
  â†“
æ­¥éª¤ 4ï¼šè¿è¡Œæµ‹è¯• + è‡ªåŠ¨ä¿®å¤
  - è¿è¡Œæµ‹è¯•å¥—ä»¶
  - å¦‚æœå¤±è´¥ï¼Œè‡ªåŠ¨ä¿®å¤ï¼ˆæœ€å¤š 3 æ¬¡ï¼‰
  - ä»å¤±è´¥åˆ™æ ‡è®°ä»»åŠ¡ä¸º failedï¼Œç»§ç»­ä¸‹ä¸€ä¸ªä»»åŠ¡
  â†“
æ­¥éª¤ 5ï¼šCodex å®¡æ ¸
  - è°ƒç”¨ Codex å®¡æ ¸ä»£ç è´¨é‡
  - å¦‚æœä¸é€šè¿‡ï¼Œè°ƒç”¨ Coder ä¿®å¤
  - é‡æ–°å®¡æ ¸ç›´åˆ°é€šè¿‡
  â†“
æ­¥éª¤ 6ï¼šGit æäº¤ + æ¨é€
  - git add . && git commit
  - è®°å½•æäº¤å“ˆå¸Œå’Œæ–‡ä»¶å˜æ›´
  - æ¨é€åˆ°è¿œç¨‹ä»“åº“ï¼ˆå¯é€‰ï¼‰
  â†“
æ­¥éª¤ 7ï¼šæ›´æ–° progress.json
  - æ ‡è®°ä»»åŠ¡ä¸º completed
  - è®°å½• Git ä¿¡æ¯
  - è®°å½•éªŒè¯ä¿¡æ¯
  - æ›´æ–° git_commits æ•°ç»„
  â†“
æ­¥éª¤ 8ï¼šåˆ¤æ–­æ˜¯å¦ç»§ç»­
  â”œâ”€ è¿˜æœ‰å¾…æ‰§è¡Œä»»åŠ¡ â†’ å›åˆ°æ­¥éª¤ 1
  â””â”€ æ‰€æœ‰ä»»åŠ¡å®Œæˆ â†’ ç”Ÿæˆæœ€ç»ˆæŠ¥å‘Š
```

---

## é˜²é‡å¤å¼€å‘æœºåˆ¶

### ä¸‰é‡æ£€æµ‹

**æ£€æµ‹ 1ï¼šå¯åŠ¨æ—¶æ£€æµ‹**
```
è¯»å– progress.json
  â†“
æ£€æŸ¥æ˜¯å¦æœ‰ in_progress çŠ¶æ€çš„ä»»åŠ¡
  â†“
ã€æœ‰ã€‘æç¤ºç”¨æˆ·ï¼š
  "æ£€æµ‹åˆ°æœªå®Œæˆçš„ä»»åŠ¡ï¼štask-2
   é€‰é¡¹ï¼š
   1. ç»§ç»­æ‰§è¡Œè¯¥ä»»åŠ¡ï¼ˆæ¨èï¼‰
   2. æ ‡è®°ä¸ºå¤±è´¥ï¼Œè·³è¿‡è¯¥ä»»åŠ¡
   3. å›é€€åˆ°è¯¥ä»»åŠ¡å¼€å§‹å‰çš„çŠ¶æ€"

ã€æ— ã€‘ç»§ç»­æ­£å¸¸æµç¨‹
```

**æ£€æµ‹ 2ï¼šé€‰æ‹©ä»»åŠ¡æ—¶æ£€æµ‹**
```python
# ä¼ªä»£ç 
for task in tasks:
    if task.status == "completed":
        continue  # è·³è¿‡å·²å®Œæˆ
    if task.status == "failed":
        continue  # è·³è¿‡å¤±è´¥
    if not all_dependencies_completed(task):
        continue  # è·³è¿‡ä¾èµ–æœªæ»¡è¶³
    return task  # æ‰¾åˆ°å¯æ‰§è¡Œä»»åŠ¡
```

**æ£€æµ‹ 3ï¼šæ‰§è¡Œå‰æ£€æµ‹**
```
è¯»å–ä»»åŠ¡çš„ç›®æ ‡æ–‡ä»¶åˆ—è¡¨
  â†“
æ£€æŸ¥è¿™äº›æ–‡ä»¶æ˜¯å¦å·²è¢«å…¶ä»–ä»»åŠ¡ä¿®æ”¹
  â†“
ã€æœ‰å†²çªã€‘è­¦å‘Šï¼š
  "âš ï¸ æ–‡ä»¶å†²çªæ£€æµ‹
   task-3 éœ€è¦ä¿®æ”¹ï¼šsrc/api/users.py
   ä½†è¯¥æ–‡ä»¶å·²è¢« task-1 ä¿®æ”¹ï¼ˆcommit: abc123ï¼‰

   æ˜¯å¦ç»§ç»­ï¼Ÿ[y/N]"

ã€æ— å†²çªã€‘ç»§ç»­æ‰§è¡Œ
```

---

## Git æäº¤è®°å½•ç®¡ç†

### æäº¤ç­–ç•¥

**ä¸€ä¸ªä»»åŠ¡ä¸€ä¸ªæäº¤**ï¼š
- æ¯ä¸ªä»»åŠ¡å®Œæˆåç«‹å³æäº¤
- æäº¤ä¿¡æ¯åŒ…å«ä»»åŠ¡ ID å’Œè¯¦ç»†æè¿°
- è®°å½•ä¿®æ”¹çš„æ–‡ä»¶åˆ—è¡¨
- æ¨é€åˆ°è¿œç¨‹ä»“åº“ï¼ˆå¯é€‰ï¼‰

### æäº¤ä¿¡æ¯æ ¼å¼

```
feat(task-1): å®ç°æƒé™æ§åˆ¶æ•°æ®åº“ç»“æ„

- æ–°å¢ roles è¡¨ï¼ˆè§’è‰²è¡¨ï¼‰
- æ–°å¢ permissions è¡¨ï¼ˆæƒé™è¡¨ï¼‰
- æ–°å¢ user_roles å…³è”è¡¨
- æ–°å¢ role_permissions å…³è”è¡¨
- æ–°å¢æ•°æ®åº“è¿ç§»è„šæœ¬

ä»»åŠ¡ ID: task-1
æµ‹è¯•è¦†ç›–ç‡: 92%
Codex å®¡æ ¸: âœ… é€šè¿‡

Co-Authored-By: Claude <noreply@anthropic.com>
```

### progress.json ä¸­çš„è®°å½•

```json
{
  "git_info": {
    "commit_hash": "abc123def456",
    "commit_message": "feat(task-1): å®ç°æƒé™æ§åˆ¶æ•°æ®åº“ç»“æ„",
    "files_changed": [
      "src/models/role.py",
      "src/models/permission.py",
      "migrations/001_add_rbac.py"
    ],
    "insertions": 156,
    "deletions": 0
  },
  "git_commits": [
    {
      "task_id": "task-1",
      "commit_hash": "abc123def456",
      "timestamp": "2026-01-17T14:45:00Z",
      "can_rollback_to": true
    }
  ]
}
```

---

## å›é€€æœºåˆ¶

### è®¾è®¡åŸåˆ™

- å›é€€æ˜¯**æ‰‹åŠ¨æ“ä½œ**ï¼Œä¸å½±å“è‡ªåŠ¨æ‰§è¡Œ
- å¤±è´¥ä»»åŠ¡è‡ªåŠ¨è·³è¿‡ï¼Œç»§ç»­ä¸‹ä¸€ä¸ªä»»åŠ¡
- ç”¨æˆ·å¯ä»¥åœ¨ä»»ä½•æ—¶å€™æ‰‹åŠ¨å›é€€

### å›é€€æµç¨‹

```
ç”¨æˆ·è¯·æ±‚å›é€€åˆ° task-2
  â†“
1. åˆ›å»ºå¤‡ä»½åˆ†æ”¯
   git branch backup-before-rollback-$(date +%Y%m%d-%H%M%S)
  â†“
2. ç¡¬å›é€€åˆ°ç›®æ ‡æäº¤
   git reset --hard <task-2çš„commit>
  â†“
3. æ›´æ–° progress.json
   - æ ‡è®° task-3+ ä¸º pending
   - è®°å½•å›é€€æ“ä½œåˆ° history
  â†“
4. è¾“å‡ºå›é€€ç»“æœ
```

### å›é€€å‘½ä»¤ç”Ÿæˆ

Claude ä¼šè‡ªåŠ¨ç”Ÿæˆå›é€€å‘½ä»¤ï¼š

```bash
# å›é€€åˆ° task-2 å®Œæˆå
git reset --hard def456ghi789

# å¤‡ä»½åˆ†æ”¯
backup-before-rollback-20260117-140000
```

---

## æ–‡ä»¶ç»“æ„

### ç”Ÿæˆçš„æ–‡ä»¶

```
é¡¹ç›®æ ¹ç›®å½•/
â”œâ”€â”€ ai/
â”‚   â”œâ”€â”€ analysis/
â”‚   â”‚   â””â”€â”€ <project>-analysis.md          # é¡¹ç›®åˆ†ææ–‡æ¡£
â”‚   â”‚
â”‚   â”œâ”€â”€ requirements/                       # æ¨¡å¼ 1 çš„è¾“å…¥
â”‚   â”‚   â””â”€â”€ <project>/
â”‚   â”‚       â”œâ”€â”€ requirements.md
â”‚   â”‚       â””â”€â”€ database-design.md
â”‚   â”‚
â”‚   â”œâ”€â”€ plans/                              # ä»»åŠ¡è®¡åˆ’
â”‚   â”‚   â”œâ”€â”€ task-1-<name>.md
â”‚   â”‚   â”œâ”€â”€ task-2-<name>.md
â”‚   â”‚   â””â”€â”€ ...
â”‚   â”‚
â”‚   â””â”€â”€ iteration/
â”‚       â””â”€â”€ <project>/
â”‚           â”œâ”€â”€ task-list.md                # ä»»åŠ¡åˆ—è¡¨
â”‚           â”œâ”€â”€ progress.json               # è¿›åº¦è·Ÿè¸ªï¼ˆæ ¸å¿ƒï¼‰
â”‚           â”œâ”€â”€ final-report.md             # æœ€ç»ˆæŠ¥å‘Š
â”‚           â””â”€â”€ logs/                       # æ‰§è¡Œæ—¥å¿—
â”‚
â””â”€â”€ .git/                                   # Git ä»“åº“
```

---

## progress.json æ ¼å¼

### å®Œæ•´æ ¼å¼

```json
{
  "project_name": "ç”¨æˆ·ç®¡ç†ç³»ç»Ÿ",
  "mode": "requirement-driven",
  "analysis_document": "ai/analysis/user-system-analysis.md",
  "task_list": "ai/iteration/user-system/task-list.md",
  "start_time": "2026-01-17T12:30:00Z",
  "last_updated": "2026-01-17T14:45:00Z",
  "current_iteration": 1,
  "total_tasks": 6,
  "completed_tasks": 1,
  "failed_tasks": 0,
  "git_enabled": true,
  "git_branch": "develop",
  "git_initial_commit": "abc123",
  "max_iterations": 20,
  "auto_confirm": false,

  "tasks": [
    {
      "id": "task-1",
      "name": "è®¾è®¡å¹¶å®ç°æƒé™æ§åˆ¶æ•°æ®åº“ç»“æ„",
      "priority": "high",
      "estimated_hours": 6,
      "status": "completed",
      "dependencies": [],

      "execution": {
        "plan_file": "ai/plans/task-1-rbac-database.md",
        "started_at": "2026-01-17T14:00:00Z",
        "completed_at": "2026-01-17T14:45:00Z",
        "duration_minutes": 45,
        "retry_count": 0,
        "last_error": null
      },

      "git_info": {
        "commit_hash": "abc123def456",
        "commit_message": "feat(task-1): å®ç°æƒé™æ§åˆ¶æ•°æ®åº“ç»“æ„",
        "files_changed": [
          "src/models/role.py",
          "src/models/permission.py",
          "migrations/001_add_rbac.py"
        ],
        "insertions": 156,
        "deletions": 0
      },

      "verification": {
        "tests_passed": true,
        "coverage": 92,
        "codex_approved": true,
        "codex_review_time": "2026-01-17T14:40:00Z"
      }
    }
  ],

  "git_commits": [
    {
      "task_id": "task-1",
      "commit_hash": "abc123def456",
      "commit_message": "feat(task-1): å®ç°æƒé™æ§åˆ¶æ•°æ®åº“ç»“æ„",
      "timestamp": "2026-01-17T14:45:00Z",
      "files_changed": ["src/models/role.py", "src/models/permission.py", "migrations/001_add_rbac.py"],
      "can_rollback_to": true
    }
  ],

  "history": [
    {
      "timestamp": "2026-01-17T14:00:00Z",
      "action": "task_started",
      "task_id": "task-1",
      "details": "å¼€å§‹æ‰§è¡Œä»»åŠ¡ï¼šè®¾è®¡å¹¶å®ç°æƒé™æ§åˆ¶æ•°æ®åº“ç»“æ„"
    },
    {
      "timestamp": "2026-01-17T14:45:00Z",
      "action": "task_completed",
      "task_id": "task-1",
      "commit_hash": "abc123def456",
      "details": "ä»»åŠ¡å®Œæˆï¼Œæµ‹è¯•é€šè¿‡ï¼ŒCodex å®¡æ ¸é€šè¿‡"
    }
  ]
}
```

---

**æ–‡æ¡£ç‰ˆæœ¬**: v1.0
**æœ€åæ›´æ–°**: 2026-01-18
**ç»´æŠ¤è€…**: CCG Team
