# CCG å¤šé¡¹ç›®ä¸Šä¸‹æ–‡éš”ç¦»æ–¹æ¡ˆ

> **ç”¨é€”**ï¼šåœ¨åŒä¸€å°æœºå™¨ä¸Šç®¡ç†å¤šä¸ªé¡¹ç›®ï¼Œç¡®ä¿é…ç½®ã€ä¼šè¯ã€æ—¥å¿—å®Œå…¨éš”ç¦»

## é—®é¢˜åˆ†æ

### å½“å‰é—®é¢˜

**ç°çŠ¶**ï¼š`.ccg/` ç›®å½•æ˜¯å…¨å±€çš„ï¼Œæ‰€æœ‰é¡¹ç›®å…±äº«ï¼š

```
.ccg/
â”œâ”€â”€ project-context.json          # âŒ å•ä¸€é¡¹ç›®é…ç½®
â”œâ”€â”€ sessions/current.json         # âŒ å•ä¸€ä¼šè¯
â”œâ”€â”€ decision_log.jsonl            # âŒ æ‰€æœ‰é¡¹ç›®æ··åœ¨ä¸€èµ·
â””â”€â”€ user_preferences.json         # âŒ å…¨å±€é…ç½®
```

**é—®é¢˜**ï¼š
1. âŒ åˆ‡æ¢é¡¹ç›®æ—¶ï¼Œä¸Šä¸‹æ–‡ä¼šæ··ä¹±
2. âŒ æ—¥å¿—æ— æ³•åŒºåˆ†é¡¹ç›®
3. âŒ é…ç½®æ— æ³•æŒ‰é¡¹ç›®å®šåˆ¶
4. âŒ ä¼šè¯æ¢å¤å¯èƒ½æ¢å¤åˆ°é”™è¯¯çš„é¡¹ç›®

---

## è§£å†³æ–¹æ¡ˆ

### æ–¹æ¡ˆ Aï¼šåŸºäºé¡¹ç›®è·¯å¾„çš„è‡ªåŠ¨éš”ç¦»ï¼ˆæ¨èï¼‰

**æ ¸å¿ƒæ€è·¯**ï¼šæ ¹æ®é¡¹ç›®æ ¹ç›®å½•è·¯å¾„è‡ªåŠ¨ç”Ÿæˆé¡¹ç›® IDï¼Œå®ç°é€æ˜éš”ç¦»ã€‚

**ç›®å½•ç»“æ„**ï¼š
```
~/.ccg/                           # å…¨å±€ CCG é…ç½®ç›®å½•
â”œâ”€â”€ global_config.json            # å…¨å±€é»˜è®¤é…ç½®
â”œâ”€â”€ projects.json                 # é¡¹ç›®æ³¨å†Œè¡¨
â””â”€â”€ projects/                     # å„é¡¹ç›®çš„éš”ç¦»ç›®å½•
    â”œâ”€â”€ project-abc123/           # é¡¹ç›® 1ï¼ˆåŸºäºè·¯å¾„ hashï¼‰
    â”‚   â”œâ”€â”€ project-context.json
    â”‚   â”œâ”€â”€ user_preferences.json
    â”‚   â”œâ”€â”€ sessions/
    â”‚   â”‚   â”œâ”€â”€ current.json
    â”‚   â”‚   â””â”€â”€ history/
    â”‚   â””â”€â”€ logs/
    â”‚       â”œâ”€â”€ decision_log.jsonl
    â”‚       â”œâ”€â”€ degradation_log.jsonl
    â”‚       â””â”€â”€ timeout_log.jsonl
    â””â”€â”€ project-def456/           # é¡¹ç›® 2
        â””â”€â”€ ...
```

**é¡¹ç›® ID ç”Ÿæˆè§„åˆ™**ï¼š
```python
import hashlib

def generate_project_id(project_path: str) -> str:
    """æ ¹æ®é¡¹ç›®ç»å¯¹è·¯å¾„ç”Ÿæˆå”¯ä¸€ ID"""
    abs_path = os.path.abspath(project_path)
    hash_obj = hashlib.sha256(abs_path.encode())
    return f"project-{hash_obj.hexdigest()[:8]}"

# ç¤ºä¾‹
# /home/user/my-app -> project-abc12345
# /home/user/another-app -> project-def67890
```

**ä¼˜åŠ¿**ï¼š
- âœ… å®Œå…¨è‡ªåŠ¨åŒ–ï¼Œç”¨æˆ·æ— æ„ŸçŸ¥
- âœ… åŒä¸€é¡¹ç›®åœ¨ä¸åŒä¼šè¯ä¸­ ID ä¸€è‡´
- âœ… ä¸åŒé¡¹ç›® ID ç»å¯¹ä¸ä¼šå†²çª
- âœ… æ”¯æŒä»»æ„æ•°é‡çš„é¡¹ç›®

---

### æ–¹æ¡ˆ Bï¼šåŸºäºé¡¹ç›®åç§°çš„æ‰‹åŠ¨éš”ç¦»

**æ ¸å¿ƒæ€è·¯**ï¼šç”¨æˆ·åœ¨é¡¹ç›®æ ¹ç›®å½•åˆ›å»º `.ccg-project` æ–‡ä»¶ï¼Œæ‰‹åŠ¨æŒ‡å®šé¡¹ç›®åç§°ã€‚

**é…ç½®æ–‡ä»¶**ï¼ˆ`.ccg-project`ï¼‰ï¼š
```json
{
  "project_id": "my-awesome-app",
  "project_name": "My Awesome App",
  "created_at": "2026-01-21"
}
```

**ä¼˜åŠ¿**ï¼š
- âœ… é¡¹ç›® ID å¯è¯»æ€§å¼º
- âœ… ç”¨æˆ·å¯ä»¥è‡ªå®šä¹‰é¡¹ç›®åç§°

**åŠ£åŠ¿**ï¼š
- âŒ éœ€è¦ç”¨æˆ·æ‰‹åŠ¨åˆ›å»ºé…ç½®æ–‡ä»¶
- âŒ å¯èƒ½å‡ºç° ID å†²çªï¼ˆä¸åŒé¡¹ç›®ä½¿ç”¨ç›¸åŒåç§°ï¼‰

---

## æ¨èæ–¹æ¡ˆï¼šæ–¹æ¡ˆ Aï¼ˆè‡ªåŠ¨éš”ç¦»ï¼‰

**ç†ç”±**ï¼š
1. ç”¨æˆ·æ— éœ€ä»»ä½•é…ç½®ï¼Œå¼€ç®±å³ç”¨
2. ç»å¯¹ä¸ä¼šå‡ºç° ID å†²çª
3. æ”¯æŒä»»æ„æ•°é‡çš„é¡¹ç›®
4. ä¸ç°æœ‰ç³»ç»Ÿå…¼å®¹ï¼ˆå¹³æ»‘è¿ç§»ï¼‰

---

## å®ç°ç»†èŠ‚

### 1. é¡¹ç›®æ³¨å†Œè¡¨ (projects.json)

**ä½ç½®**ï¼š`~/.ccg/projects.json`

**æ ¼å¼**ï¼š
```json
{
  "version": "1.0.0",
  "projects": {
    "project-abc12345": {
      "project_id": "project-abc12345",
      "project_path": "/home/user/my-app",
      "project_name": "My App",
      "created_at": "2026-01-21T10:00:00Z",
      "last_accessed": "2026-01-21T14:30:00Z",
      "access_count": 15
    },
    "project-def67890": {
      "project_id": "project-def67890",
      "project_path": "/home/user/another-app",
      "project_name": "Another App",
      "created_at": "2026-01-20T09:00:00Z",
      "last_accessed": "2026-01-21T12:00:00Z",
      "access_count": 8
    }
  },
  "current_project_id": "project-abc12345"
}
```

**å­—æ®µè¯´æ˜**ï¼š
- `project_id` - é¡¹ç›®å”¯ä¸€æ ‡è¯†ç¬¦ï¼ˆåŸºäºè·¯å¾„ hashï¼‰
- `project_path` - é¡¹ç›®ç»å¯¹è·¯å¾„
- `project_name` - é¡¹ç›®åç§°ï¼ˆä» package.json/pyproject.toml è¯»å–ï¼‰
- `created_at` - é¦–æ¬¡è®¿é—®æ—¶é—´
- `last_accessed` - æœ€åè®¿é—®æ—¶é—´
- `access_count` - è®¿é—®æ¬¡æ•°
- `current_project_id` - å½“å‰æ´»è·ƒé¡¹ç›®

### 2. é¡¹ç›®ç›®å½•ç»“æ„

**æ¯ä¸ªé¡¹ç›®çš„éš”ç¦»ç›®å½•**ï¼š

```
~/.ccg/projects/project-abc12345/
â”œâ”€â”€ project-context.json          # é¡¹ç›®é™æ€ä¿¡æ¯
â”œâ”€â”€ user_preferences.json         # é¡¹ç›®ç‰¹å®šé…ç½®ï¼ˆè¦†ç›–å…¨å±€ï¼‰
â”œâ”€â”€ sessions/
â”‚   â”œâ”€â”€ current.json              # å½“å‰ä¼šè¯
â”‚   â””â”€â”€ history/
â”‚       â”œâ”€â”€ session-20260121-001.json
â”‚       â””â”€â”€ session-20260120-002.json
â””â”€â”€ logs/
    â”œâ”€â”€ decision_log.jsonl        # å†³ç­–æ—¥å¿—
    â”œâ”€â”€ degradation_log.jsonl     # é™çº§æ—¥å¿—
    â””â”€â”€ timeout_log.jsonl         # è¶…æ—¶æ—¥å¿—
```

### 3. é…ç½®ç»§æ‰¿æœºåˆ¶

**é…ç½®ä¼˜å…ˆçº§**ï¼ˆä»é«˜åˆ°ä½ï¼‰ï¼š

```
é¡¹ç›®ç‰¹å®šé…ç½® > å…¨å±€é…ç½® > ç³»ç»Ÿé»˜è®¤å€¼
```

**ç¤ºä¾‹**ï¼š
```
~/.ccg/global_config.json         # å…¨å±€é»˜è®¤é…ç½®
    â†“ ç»§æ‰¿
~/.ccg/projects/project-abc/user_preferences.json  # é¡¹ç›®è¦†ç›–
```

**åˆå¹¶è§„åˆ™**ï¼š
- é¡¹ç›®é…ç½®ä¸­å­˜åœ¨çš„å­—æ®µï¼Œä½¿ç”¨é¡¹ç›®é…ç½®
- é¡¹ç›®é…ç½®ä¸­ä¸å­˜åœ¨çš„å­—æ®µï¼Œä½¿ç”¨å…¨å±€é…ç½®
- éƒ½ä¸å­˜åœ¨ï¼Œä½¿ç”¨ç³»ç»Ÿé»˜è®¤å€¼

### 4. é¡¹ç›®è‡ªåŠ¨æ£€æµ‹å’Œåˆ‡æ¢

**æ£€æµ‹æµç¨‹**ï¼š

```
Claude å¯åŠ¨
    â†“
è·å–å½“å‰å·¥ä½œç›®å½• (cwd)
    â†“
ç”Ÿæˆé¡¹ç›® ID (hash(cwd))
    â†“
æ£€æŸ¥é¡¹ç›®æ˜¯å¦å·²æ³¨å†Œ
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¡¹ç›®å·²æ³¨å†Œï¼Ÿ         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“ æ˜¯              â†“ å¦
åŠ è½½é¡¹ç›®é…ç½®      æ³¨å†Œæ–°é¡¹ç›®
    â†“                  â†“
æ›´æ–° last_accessed  åˆ›å»ºé¡¹ç›®ç›®å½•
    â†“                  â†“
è®¾ç½®ä¸ºå½“å‰é¡¹ç›®    åˆå§‹åŒ–é…ç½®
```

**è‡ªåŠ¨æ³¨å†Œæ–°é¡¹ç›®**ï¼š

```python
def register_project(project_path: str):
    """è‡ªåŠ¨æ³¨å†Œæ–°é¡¹ç›®"""
    project_id = generate_project_id(project_path)
    project_name = detect_project_name(project_path)

    # åˆ›å»ºé¡¹ç›®ç›®å½•
    project_dir = f"~/.ccg/projects/{project_id}"
    os.makedirs(project_dir, exist_ok=True)
    os.makedirs(f"{project_dir}/sessions/history", exist_ok=True)
    os.makedirs(f"{project_dir}/logs", exist_ok=True)

    # æ³¨å†Œåˆ° projects.json
    projects_data = load_projects_json()
    projects_data["projects"][project_id] = {
        "project_id": project_id,
        "project_path": project_path,
        "project_name": project_name,
        "created_at": datetime.now().isoformat(),
        "last_accessed": datetime.now().isoformat(),
        "access_count": 1
    }
    save_projects_json(projects_data)
```

### 5. é¡¹ç›®åˆ‡æ¢æœºåˆ¶

**æ‰‹åŠ¨åˆ‡æ¢**ï¼ˆå¦‚æœéœ€è¦ï¼‰ï¼š

```bash
# åˆ‡æ¢åˆ°æŒ‡å®šé¡¹ç›®
ccg switch /path/to/project

# åˆ—å‡ºæ‰€æœ‰é¡¹ç›®
ccg list-projects

# æŸ¥çœ‹å½“å‰é¡¹ç›®
ccg current-project
```

**è‡ªåŠ¨åˆ‡æ¢**ï¼ˆæ¨èï¼‰ï¼š

- Claude æ ¹æ®å½“å‰å·¥ä½œç›®å½•è‡ªåŠ¨åˆ‡æ¢
- æ— éœ€ç”¨æˆ·æ‰‹åŠ¨æ“ä½œ
- é€æ˜æ— æ„ŸçŸ¥

---

## ä½¿ç”¨åœºæ™¯

### åœºæ™¯ 1ï¼šå¼€å‘å¤šä¸ªç‹¬ç«‹é¡¹ç›®

**æƒ…å†µ**ï¼š
```
~/projects/
â”œâ”€â”€ my-app/           # é¡¹ç›® A
â”œâ”€â”€ another-app/      # é¡¹ç›® B
â””â”€â”€ third-app/        # é¡¹ç›® C
```

**æ•ˆæœ**ï¼š
- åœ¨ `my-app/` ç›®å½•å·¥ä½œæ—¶ï¼Œè‡ªåŠ¨ä½¿ç”¨é¡¹ç›® A çš„é…ç½®å’Œæ—¥å¿—
- åˆ‡æ¢åˆ° `another-app/` æ—¶ï¼Œè‡ªåŠ¨åˆ‡æ¢åˆ°é¡¹ç›® B
- é…ç½®ã€ä¼šè¯ã€æ—¥å¿—å®Œå…¨éš”ç¦»

### åœºæ™¯ 2ï¼šåŒä¸€é¡¹ç›®çš„ä¸åŒåˆ†æ”¯

**æƒ…å†µ**ï¼š
```
~/projects/
â”œâ”€â”€ my-app/           # main åˆ†æ”¯
â””â”€â”€ my-app-feature/   # feature åˆ†æ”¯ï¼ˆä¸åŒç›®å½•ï¼‰
```

**æ•ˆæœ**ï¼š
- ä¸¤ä¸ªç›®å½•è¢«è¯†åˆ«ä¸ºä¸åŒé¡¹ç›®
- å„è‡ªç‹¬ç«‹çš„é…ç½®å’Œä¼šè¯
- é¿å…åˆ†æ”¯åˆ‡æ¢æ—¶çš„ä¸Šä¸‹æ–‡æ··ä¹±

### åœºæ™¯ 3ï¼šå®¢æˆ·é¡¹ç›®ç®¡ç†

**æƒ…å†µ**ï¼š
```
~/clients/
â”œâ”€â”€ client-a-project/
â”œâ”€â”€ client-b-project/
â””â”€â”€ client-c-project/
```

**æ•ˆæœ**ï¼š
- æ¯ä¸ªå®¢æˆ·é¡¹ç›®ç‹¬ç«‹é…ç½®
- æ—¥å¿—åˆ†å¼€è®°å½•ï¼Œä¾¿äºå®¡è®¡
- é…ç½®å¯ä»¥æŒ‰å®¢æˆ·éœ€æ±‚å®šåˆ¶

---

## è¿ç§»æŒ‡å—

### ä»å•é¡¹ç›®åˆ°å¤šé¡¹ç›®

**å½“å‰çŠ¶æ€**ï¼ˆå•é¡¹ç›®ï¼‰ï¼š
```
.ccg/
â”œâ”€â”€ project-context.json
â”œâ”€â”€ sessions/current.json
â””â”€â”€ decision_log.jsonl
```

**è¿ç§»å**ï¼ˆå¤šé¡¹ç›®ï¼‰ï¼š
```
~/.ccg/
â”œâ”€â”€ global_config.json
â”œâ”€â”€ projects.json
â””â”€â”€ projects/
    â””â”€â”€ project-abc12345/
        â”œâ”€â”€ project-context.json
        â”œâ”€â”€ sessions/current.json
        â””â”€â”€ logs/decision_log.jsonl
```

**è¿ç§»æ­¥éª¤**ï¼š

1. **å¤‡ä»½ç°æœ‰æ•°æ®**ï¼š
   ```bash
   cp -r .ccg .ccg.backup
   ```

2. **è‡ªåŠ¨è¿ç§»**ï¼ˆæ¨èï¼‰ï¼š
   ```bash
   # CCG ä¼šè‡ªåŠ¨æ£€æµ‹æ—§æ ¼å¼å¹¶è¿ç§»
   # é¦–æ¬¡å¯åŠ¨æ—¶è‡ªåŠ¨æ‰§è¡Œ
   ```

3. **æ‰‹åŠ¨è¿ç§»**ï¼ˆå¦‚æœéœ€è¦ï¼‰ï¼š
   ```bash
   # åˆ›å»ºæ–°ç›®å½•ç»“æ„
   mkdir -p ~/.ccg/projects

   # ç§»åŠ¨ç°æœ‰é…ç½®åˆ°é¡¹ç›®ç›®å½•
   PROJECT_ID=$(python -c "import hashlib; print('project-' + hashlib.sha256('$(pwd)'.encode()).hexdigest()[:8])")
   mkdir -p ~/.ccg/projects/$PROJECT_ID
   mv .ccg/* ~/.ccg/projects/$PROJECT_ID/
   ```

---

## å®ç°çŠ¶æ€

### âŒ å½“å‰æœªå®ç°

CCG ç³»ç»Ÿç›®å‰**å°šæœªå®ç°**å¤šé¡¹ç›®éš”ç¦»æœºåˆ¶ã€‚

**ç°çŠ¶**ï¼š
- æ‰€æœ‰é…ç½®å’Œæ—¥å¿—å­˜å‚¨åœ¨é¡¹ç›®æ ¹ç›®å½•çš„ `.ccg/` ä¸­
- åˆ‡æ¢é¡¹ç›®æ—¶ä¼šä¸¢å¤±ä¸Šä¸‹æ–‡
- å¤šé¡¹ç›®å¼€å‘æ—¶å®¹æ˜“æ··ä¹±

### âœ… è®¡åˆ’å®ç°

**ä¼˜å…ˆçº§**ï¼šğŸ”´ é«˜ï¼ˆå»ºè®®å°½å¿«å®ç°ï¼‰

**å®ç°æ–¹å¼**ï¼š
1. åœ¨ CCG MCP æœåŠ¡å™¨ä¸­æ·»åŠ é¡¹ç›®æ£€æµ‹é€»è¾‘
2. è‡ªåŠ¨åˆ›å»ºå’Œç®¡ç† `~/.ccg/projects/` ç›®å½•
3. æä¾›è¿ç§»å·¥å…·

**é¢„è®¡å·¥ä½œé‡**ï¼š2-3 å¤©

---

## å¿«é€Ÿå‚è€ƒ

### ç›®å½•ç»“æ„å¯¹æ¯”

**å½“å‰ï¼ˆå•é¡¹ç›®ï¼‰**ï¼š
```
é¡¹ç›®æ ¹ç›®å½•/.ccg/
â”œâ”€â”€ project-context.json
â”œâ”€â”€ user_preferences.json
â”œâ”€â”€ sessions/
â””â”€â”€ logs/
```

**æœªæ¥ï¼ˆå¤šé¡¹ç›®ï¼‰**ï¼š
```
~/.ccg/
â”œâ”€â”€ global_config.json
â”œâ”€â”€ projects.json
â””â”€â”€ projects/
    â”œâ”€â”€ project-abc123/
    â””â”€â”€ project-def456/
```

### å…³é”®æ¦‚å¿µ

- **é¡¹ç›® ID**ï¼šåŸºäºé¡¹ç›®è·¯å¾„çš„ hash å€¼
- **é¡¹ç›®æ³¨å†Œè¡¨**ï¼š`~/.ccg/projects.json`
- **é…ç½®ç»§æ‰¿**ï¼šé¡¹ç›®é…ç½® > å…¨å±€é…ç½® > é»˜è®¤å€¼
- **è‡ªåŠ¨åˆ‡æ¢**ï¼šæ ¹æ®å·¥ä½œç›®å½•è‡ªåŠ¨åˆ‡æ¢é¡¹ç›®

---

## ç›¸å…³æ–‡æ¡£

- **ä¼šè¯ç®¡ç†**ï¼š`skills/ccg-session-manager/`
- **æ—¥å¿—åˆ†æ**ï¼š`ai/logging/log_analysis_guide.md`
- **ç”¨æˆ·é…ç½®**ï¼š`.ccg/user_preferences.json`

